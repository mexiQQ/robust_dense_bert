Namespace(adam_epsilon=1e-08, bias_correction=True, bsz=32, ckpt_dir=PosixPath('outputs3'), dataset_name='glue', debug=False, do_lower_case=True, epochs=30, eval_size=32, force_overwrite='1', lr=2e-05, max_seq_length=128, model_name='bert-base-uncased', num_examples=872, num_labels=2, result_file='attack_result.csv', seed=0, task_name='sst2', warmup_ratio=0.1, weight_decay=0.01)
Making checkpoint directory: outputs3/finetune_glue-sst2_lr2e-05_epochs30_seed0_time1680685731203
Epoch: 0, Loss:  0.3574, Lr:  6.668e-06, Dev_Accuracy: 0.9013761467889907
**** Test Accuracy: 0.9013761467889907, Test_Loss: 0.2534012302224116
Epoch: 1, Loss:  0.1635, Lr:  1.334e-05, Dev_Accuracy: 0.918577981651376
**** Test Accuracy: 0.918577981651376, Test_Loss: 0.24152256734669122
Epoch: 2, Loss:  0.1161, Lr:  2.000e-05, Dev_Accuracy: 0.9208715596330274
**** Test Accuracy: 0.9208715596330274, Test_Loss: 0.20848880961005103
Epoch: 3, Loss:  0.0863, Lr:  1.926e-05, Dev_Accuracy: 0.9243119266055044
**** Test Accuracy: 0.9243119266055044, Test_Loss: 0.22850773550037745
Epoch: 4, Loss:  0.0600, Lr:  1.852e-05, Dev_Accuracy: 0.9288990825688073
**** Test Accuracy: 0.9288990825688073, Test_Loss: 0.20572098470958142
Epoch: 5, Loss:  0.0426, Lr:  1.778e-05, Dev_Accuracy: 0.9220183486238531
Epoch: 6, Loss:  0.0332, Lr:  1.704e-05, Dev_Accuracy: 0.93348623853211
**** Test Accuracy: 0.93348623853211, Test_Loss: 0.24857034693871138
Epoch: 7, Loss:  0.0254, Lr:  1.630e-05, Dev_Accuracy: 0.9231651376146788
Epoch: 8, Loss:  0.0212, Lr:  1.555e-05, Dev_Accuracy: 0.9208715596330274
Epoch: 9, Loss:  0.0175, Lr:  1.481e-05, Dev_Accuracy: 0.9288990825688073
Epoch: 10, Loss:  0.0156, Lr:  1.407e-05, Dev_Accuracy: 0.918577981651376
Epoch: 11, Loss:  0.0132, Lr:  1.333e-05, Dev_Accuracy: 0.9174311926605503
Epoch: 12, Loss:  0.0109, Lr:  1.259e-05, Dev_Accuracy: 0.9231651376146788
Epoch: 13, Loss:  0.0097, Lr:  1.185e-05, Dev_Accuracy: 0.9208715596330274
Epoch: 14, Loss:  0.0087, Lr:  1.111e-05, Dev_Accuracy: 0.9128440366972476
Epoch: 15, Loss:  0.0073, Lr:  1.037e-05, Dev_Accuracy: 0.9208715596330274
Epoch: 16, Loss:  0.0055, Lr:  9.627e-06, Dev_Accuracy: 0.9208715596330274
Epoch: 17, Loss:  0.0059, Lr:  8.887e-06, Dev_Accuracy: 0.9254587155963302
Epoch: 18, Loss:  0.0049, Lr:  8.146e-06, Dev_Accuracy: 0.9243119266055044
Epoch: 19, Loss:  0.0040, Lr:  7.405e-06, Dev_Accuracy: 0.9220183486238531
Epoch: 20, Loss:  0.0038, Lr:  6.664e-06, Dev_Accuracy: 0.9162844036697246
Epoch: 21, Loss:  0.0029, Lr:  5.923e-06, Dev_Accuracy: 0.9197247706422017
Epoch: 22, Loss:  0.0019, Lr:  5.182e-06, Dev_Accuracy: 0.9208715596330274
Epoch: 23, Loss:  0.0015, Lr:  4.441e-06, Dev_Accuracy: 0.9174311926605503
Epoch: 24, Loss:  0.0020, Lr:  3.700e-06, Dev_Accuracy: 0.9174311926605503
Epoch: 25, Loss:  0.0010, Lr:  2.960e-06, Dev_Accuracy: 0.9162844036697246
Epoch: 26, Loss:  0.0007, Lr:  2.219e-06, Dev_Accuracy: 0.9197247706422017
Epoch: 27, Loss:  0.0006, Lr:  1.478e-06, Dev_Accuracy: 0.9220183486238531
Epoch: 28, Loss:  0.0006, Lr:  7.370e-07, Dev_Accuracy: 0.9208715596330274
Epoch: 29, Loss:  0.0004, Lr:  0.000e+00, Dev_Accuracy: 0.9231651376146788
**** Best dev metric: 0.93348623853211 in Epoch: 6
**** Best Test metric: 0.93348623853211 in Epoch: 6
Last epoch test_accuracy: 0.9231651376146788, test_loss: 0.5895914978214651
Spend time: 1.1241666666666668
